theme(panel.background = element_blank(),
axis.text.x = element_blank())
}
if (PlotType=="monthlyTotDaily") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm),color="green") +
geom_line(aes(y=Active_Daily*30),color="blue")
}
if (PlotType=="weekdayS1") {
plot <- ggplot(data=DataSet,
aes(x=WD,y = Sub1,
fill=factor(ifelse(WD=="zo" | WD=="za","Weekend","Weekday")))) +
geom_bar(stat = "identity") +
scale_fill_manual(name = "part of week", values=c("grey50", "red"))
}
if (PlotType=="minuteS2") {
plot <- ggplot(data=DataSet %>% filter(Date>="2009-06-08" & Date <= "2009-06-08") ,
aes(x=DateTime, y=Sub2)) +
geom_line(color="red")
}
if (PlotType=="minuteS3") {
plot <- ggplot(data=DataSet %>% filter(Date>="2007-02-17" & Date <= "2007-02-17") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
}
if (PlotType=="monthlyS3_2009") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet %>% filter(year==2009),
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
return(plot)
}
CreatePlots(monthlyData, "monthlyTot")
CreatePlots <- function(DataSet, PlotType) {
if (PlotType=="dailyS1") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="red")
}
if (PlotType=="dailyS2") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="blue")
}
if (PlotType=="dailyS3") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS1") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub1, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS2") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub2, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS3") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyTot") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm/1000,color="Total",size=0.25)) +
geom_line(aes(y=Other_whm/1000,color="Other",size=0.25)) +
geom_line(aes(y=(Active_whm-Other_whm)/1000,color="Sub-Metered",size=0.25)) +
scale_color_discrete(name = "Meter",
labels = c("Total"="Total", "Other"="Other", "Sub-Metered" ="Sub-Metered")) +
labs( x="time", y = "Energy consumption (in kwh)") +
theme(panel.background = element_blank(),
axis.text.x = element_blank())
}
if (PlotType=="monthlyTotDaily") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm),color="green") +
geom_line(aes(y=Active_Daily*30),color="blue")
}
if (PlotType=="weekdayS1") {
plot <- ggplot(data=DataSet,
aes(x=WD,y = Sub1,
fill=factor(ifelse(WD=="zo" | WD=="za","Weekend","Weekday")))) +
geom_bar(stat = "identity") +
scale_fill_manual(name = "part of week", values=c("grey50", "red"))
}
if (PlotType=="minuteS2") {
plot <- ggplot(data=DataSet %>% filter(Date>="2009-06-08" & Date <= "2009-06-08") ,
aes(x=DateTime, y=Sub2)) +
geom_line(color="red")
}
if (PlotType=="minuteS3") {
plot <- ggplot(data=DataSet %>% filter(Date>="2007-02-17" & Date <= "2007-02-17") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
}
if (PlotType=="monthlyS3_2009") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet %>% filter(year==2009),
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
return(plot)
}
CreatePlots(monthlyData, "monthlyTot")
CreatePlots <- function(DataSet, PlotType) {
if (PlotType=="dailyS1") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="red")
}
if (PlotType=="dailyS2") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="blue")
}
if (PlotType=="dailyS3") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS1") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub1, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS2") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub2, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS3") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyTot") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm/1000,color="Total",size=0.25)) +
geom_line(aes(y=Other_whm/1000,color="Other")) +
geom_line(aes(y=(Active_whm-Other_whm)/1000,color="Sub-Metered",size=0.25)) +
scale_color_discrete(name = "Meter",
labels = c("Total"="Total", "Other"="Other", "Sub-Metered" ="Sub-Metered")) +
labs( x="time", y = "Energy consumption (in kwh)") +
theme(panel.background = element_blank(),
axis.text.x = element_blank())
}
if (PlotType=="monthlyTotDaily") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm),color="green") +
geom_line(aes(y=Active_Daily*30),color="blue")
}
if (PlotType=="weekdayS1") {
plot <- ggplot(data=DataSet,
aes(x=WD,y = Sub1,
fill=factor(ifelse(WD=="zo" | WD=="za","Weekend","Weekday")))) +
geom_bar(stat = "identity") +
scale_fill_manual(name = "part of week", values=c("grey50", "red"))
}
if (PlotType=="minuteS2") {
plot <- ggplot(data=DataSet %>% filter(Date>="2009-06-08" & Date <= "2009-06-08") ,
aes(x=DateTime, y=Sub2)) +
geom_line(color="red")
}
if (PlotType=="minuteS3") {
plot <- ggplot(data=DataSet %>% filter(Date>="2007-02-17" & Date <= "2007-02-17") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
}
if (PlotType=="monthlyS3_2009") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet %>% filter(year==2009),
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
return(plot)
}
CreatePlots(monthlyData, "monthlyTot")
monthlyTS
autoplot(decompose(monthlyTS))
monthlyTS_S1  <- ts(FullMonths$Sub1,start=2007, frequency=12)
monthlyTS_S2  <- ts(FullMonths$Sub2,start=2007, frequency=12)
monthlyTS_S3  <- ts(FullMonths$Sub3,start=2007, frequency=12)
autoplot(decompose(monthlyTS_S1))
autoplot(decompose(monthlyTS_S2))
autoplot(decompose(monthlyTS_S3))
CreatePlots(TotalMinuteData, "minuteS3")
CreatePlots(TotalMinuteData, "minuteS2")
CreatePlots <- function(DataSet, PlotType) {
if (PlotType=="dailyS1") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="red")
}
if (PlotType=="dailyS2") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="blue")
}
if (PlotType=="dailyS3") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS1") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub1, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS2") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub2, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS3") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyTot") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm/1000,color="Total",size=0.25)) +
geom_line(aes(y=Other_whm/1000,color="Other")) +
geom_line(aes(y=(Active_whm-Other_whm)/1000,color="Sub-Metered",size=0.25)) +
scale_color_discrete(name = "Meter",
labels = c("Total"="Total", "Other"="Other", "Sub-Metered" ="Sub-Metered")) +
labs( x="time", y = "Energy consumption (in kwh)") +
theme(panel.background = element_blank(),
axis.text.x = element_blank())
}
if (PlotType=="monthlyTotDaily") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm),color="green") +
geom_line(aes(y=Active_Daily*30),color="blue")
}
if (PlotType=="weekdayS1") {
plot <- ggplot(data=DataSet,
aes(x=WD,y = Sub1,
fill=factor(ifelse(WD=="zo" | WD=="za","Weekend","Weekday")))) +
geom_bar(stat = "identity") +
scale_fill_manual(name = "part of week", values=c("grey50", "red"))
}
if (PlotType=="minuteS2") {
plot <- ggplot(data=DataSet %>% filter(Date>="2009-06-08" & Date <= "2009-06-08") ,
aes(x=DateTime, y=Sub2)) +
geom_line(color="red")
}
if (PlotType=="minuteS3") {
plot <- ggplot(data=DataSet %>% filter(Date>="2009-02-17" & Date <= "2009-02-20") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
}
if (PlotType=="monthlyS3_2009") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet %>% filter(year==2009),
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
return(plot)
}
# CreatePlots(monthlyData, "monthlyS1")          # Sub1 monthly basis
# CreatePlots(monthlyData, "monthlyS2")          # Sub2 monthly basis
# CreatePlots(monthlyData, "monthlyS3")          # Sub3 monthly basis
# CreatePlots(monthlyData, "monthlyS3_2009")     # Sub3 monthly basis (2009 only)
# CreatePlots(monthlyData, "monthlyTot")         # Total & other & subs on monthly basis
# CreatePlots(monthlyData, "monthlyTotDaily")    # Total vs on daily average (30-days)
# CreatePlots(TotalMinuteData, "minuteS2")       #
# CreatePlots(TotalMinuteData, "minuteS3")       # Sub3 minute-data. fraction of period
# CreatePlots(weekdayData, "weekdayS1")          # Sub1 weekday basis
# ggseasonplot(monthlyTS, col=rainbow(12), year.labels=TRUE)
autoplot(monthlyTS) +
autolayer(FC_M_mean, series="Mean", PI=FALSE) +
autolayer(FC_M_rwf, series="Drift", PI=FALSE) +
autolayer(FC_M_naive, series="Naïve", PI=FALSE) +
autolayer(FC_M_snaive,series="Seasonal naïve", PI=FALSE) +
ggtitle("Forecasts for monthly average daily energy consumption") +
xlab("Year") + ylab("watt-hour per minute") +
guides(colour=guide_legend(title="Forecast"))
CreatePlots(TotalMinuteData, "minuteS3")
plot <- ggplot(data=TotalMinuteData %>% filter(Date>="2009-07-17" & Date <= "2009-07-20") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
plot <- ggplot(data=TotalMinuteData %>% filter(Date>="2009-07-17" & Date <= "2009-07-20") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
plot <- ggplot(data=TotalMinuteData %>% filter(Date>="2009-08-17" & Date <= "2009-08-20") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
ggplot(data=TotalMinuteData %>% filter(Date>="2009-08-17" & Date <= "2009-08-20") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
ggplot(data=TotalMinuteData %>% filter(Date>="2007-03-17" & Date <= "2007-03-20") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
ggplot(data=TotalMinuteData %>% filter(Date>="2007-03-01" & Date <= "2007-03-07") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
ggplot(data=TotalMinuteData %>% filter(Date>="2007-03-01" & Date <= "2007-03-31") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
ggplot(data=TotalMinuteData %>% filter(Date>="2007-03-01" & Date <= "2007-03-07") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
ggplot(data=TotalMinuteData %>% filter(Date>="2009-03-01" & Date <= "2009-03-07") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
ggplot(data=TotalMinuteData %>% filter(Date>="2009-08-01" & Date <= "2009-08-07") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
ggplot(data=TotalMinuteData %>% filter(Date>="2009-09-01" & Date <= "2009-09-07") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
ggplot(data=TotalMinuteData %>% filter(Date>="2007-09-01" & Date <= "2007-09-07") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red")
CreatePlots <- function(DataSet, PlotType) {
if (PlotType=="dailyS1") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="red")
}
if (PlotType=="dailyS2") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="blue")
}
if (PlotType=="dailyS3") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS1") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub1, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS2") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub2, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS3") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyTot") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm/1000,color="Total",size=0.25)) +
geom_line(aes(y=Other_whm/1000,color="Other")) +
geom_line(aes(y=(Active_whm-Other_whm)/1000,color="Sub-Metered",size=0.25)) +
scale_color_discrete(name = "Meter",
labels = c("Total"="Total", "Other"="Other", "Sub-Metered" ="Sub-Metered")) +
labs( x="time", y = "Energy consumption (in kwh)") +
theme(panel.background = element_blank(),
axis.text.x = element_blank())
}
if (PlotType=="monthlyTotDaily") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm),color="green") +
geom_line(aes(y=Active_Daily*30),color="blue")
}
if (PlotType=="weekdayS1") {
plot <- ggplot(data=DataSet,
aes(x=WD,y = Sub1,
fill=factor(ifelse(WD=="zo" | WD=="za","Weekend","Weekday")))) +
geom_bar(stat = "identity") +
scale_fill_manual(name = "part of week", values=c("grey50", "red"))
}
if (PlotType=="minuteS2") {
plot <- ggplot(data=DataSet %>% filter(Date>="2009-06-08" & Date <= "2009-06-08") ,
aes(x=DateTime, y=Sub2)) +
geom_line(color="red")
}
if (PlotType=="minuteS3") {
plot <- ggplot(data=DataSet %>% filter(Date>="2009-09-01" & Date <= "2009-09-07") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red") +
theme(panel.background = element_blank())
}
if (PlotType=="monthlyS3_2009") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet %>% filter(year==2009),
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
return(plot)
}
CreatePlots(TotalMinuteData, "minuteS3")
CreatePlots <- function(DataSet, PlotType) {
if (PlotType=="dailyS1") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="red")
}
if (PlotType=="dailyS2") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="blue")
}
if (PlotType=="dailyS3") {
plot <- ggplot(data=DataSet,
aes(x=Date, y=Sub1, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS1") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub1, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS2") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub2, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyS3") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
if (PlotType=="monthlyTot") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm/1000,color="Total",size=0.25)) +
geom_line(aes(y=Other_whm/1000,color="Other")) +
geom_line(aes(y=(Active_whm-Other_whm)/1000,color="Sub-Metered",size=0.25)) +
scale_color_discrete(name = "Meter",
labels = c("Total"="Total", "Other"="Other", "Sub-Metered" ="Sub-Metered")) +
labs( x="time", y = "Energy consumption (in kwh)") +
theme(panel.background = element_blank(),
axis.text.x = element_blank())
}
if (PlotType=="monthlyTotDaily") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet,
aes(x=yearmonth, group=1)) +
geom_line(aes(y=Active_whm),color="green") +
geom_line(aes(y=Active_Daily*30),color="blue")
}
if (PlotType=="weekdayS1") {
plot <- ggplot(data=DataSet,
aes(x=WD,y = Sub1,
fill=factor(ifelse(WD=="zo" | WD=="za","Weekend","Weekday")))) +
geom_bar(stat = "identity") +
scale_fill_manual(name = "part of week", values=c("grey50", "red"))
}
if (PlotType=="minuteS2") {
plot <- ggplot(data=DataSet %>% filter(Date>="2009-06-08" & Date <= "2009-06-08") ,
aes(x=DateTime, y=Sub2)) +
geom_line(color="red")
}
if (PlotType=="minuteS3") {
plot <- ggplot(data=DataSet %>% filter(Date>="2007-09-01" & Date <= "2007-09-07") ,
aes(x=DateTime, y=Sub3)) +
geom_line(color="red") +
theme(panel.background = element_blank())
}
if (PlotType=="monthlyS3_2009") {
DataSet$yearmonth <- as.character(DataSet$yearmonth)
plot <- ggplot(data=DataSet %>% filter(year==2009),
aes(x=yearmonth, y=Sub3, group=1)) +
geom_line(color="green")
}
return(plot)
}
CreatePlots(TotalMinuteData, "minuteS3")
autoplot(decompose(monthlyTS))
runApp('Shinyapp03.R')
ggplot(TotalMinuteData, aes(x=Sub3)) +
geom_histogram(binwidth=1, colour="black", fill="white")
runApp('Shinyapp03.R')
TotalMinuteData %>% filter(Sub3=4)
TotalMinuteData %>% filter(Sub3==4)
TotalMinuteData %>% filter(Sub3==5)
tail(TotalMinuteData %>% filter(Sub3==5),20)
runApp('Shinyapp03.R')
